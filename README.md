# Pixel Plan Injection (pts-plan)

## О расширении

Это неофициальное расширение для браузера, которое делает интерфейс Пиксель План 24 более удобным, читаемым и приятным.

По вопросам, идеям и отзывам пишите:
- В Plan: [Данил Мелентьев](https://plan.pixelplus.ru/company/personal/user/4594/)
- В Telegram: [@melentq](https://t.me/melentq)

[Ссылка на расширение](https://chromewebstore.google.com/detail/pixel-plan-injection/eegoledaddiobcdgpdmpjcbcelcildio)

## Функционал

- **Заметные упоминания**: Делает упоминания с вами заметными. Необходимо указать ID пользователя. Настраивается цвет текста, цвет рамки и фон с пресетами.
- **Фон новых комментариев**: Меняет заливку непрочитанных комментариев в задачах. Настраивается цвет фона с пресетами (светлые тона для гармонии с интерфейсом Bitrix24).
- **Цвет `TAGALL`**: Делает метку `TAGALL` в комментариях более заметной. Настраивается цвет текста с пресетами (красный, оранжевый и т.д.).
- **Оформление цитат**: Меняет фон и рамку у цитат в комментариях и задачах. Настраивается цвет фона и рамки с пресетами.
- **Таблица баллов спринта**: Добавляет счётчик story points в канбан-доске для отслеживания прогресса спринта.
- **Сводка спринтов**: Показывает итоги по завершённым спринтам в канбане для быстрого обзора результатов.
- **Кнопка названия коммита**: Добавляет кнопку, которая генерирует готовое название коммита из заголовка задачи.
- **Не обрезать длинные ссылки**: Автоматически возвращает длинные ссылки в описание и комментарии без обрезки.
- **Кнопка «Все комментарии»**: Добавляет кнопку для загрузки всех комментариев в задаче одним кликом.
- **Кнопка «Удалить уведомления»**: Добавляет кнопку для удаления всех уведомлений задачи.
- **Кнопка «Удалить системные уведомления»**: Добавляет кнопку для удаления всех системных уведомлений.
- **Автовыбор единственного пользователя**: При добавлении упоминания через «+» автоматически выбирает пользователя, если поиск выдал только один результат.
- **Неработающие упоминания**: Подсвечивает пользователей, не добавленных в задачу, и комментарии без упоминаний в первых 100 символах.
- **Название проекта в `title`**: Добавляет название текущего проекта/группы в заголовок браузерной вкладки для удобного поиска среди открытых вкладок.
- **Автозакрытие чужих уведомлений**: Автоматически закрывает уведомления о комментариях, в которых вас не упомянули. Требует указания имени пользователя.
- **Баннер с котами**: Добавляет баннер с котами в боковое меню (работает с VPN, 10 случайных фото меняются каждые 6 минут).

Все цвета спокойные, светлые и идеально вписываются в светлую тему Bitrix24 / Пиксель План. Для цветовых настроек доступны пресеты и превью прямо в настройках расширения. Функции, зависящие от ID или имени пользователя, отключены до их указания.

## Разработка

### Запуск в режиме разработки

```bash
npm run dev
```

### Сборка для публикации

```bash
npm run build
```

### Стек

* [Create Chrome Extension (.crx)](https://github.com/guocaoyi/create-chrome-ext)
* [PrimeVue](https://primevue.org/)
* [Tailwind CSS](https://tailwindcss.com/)

### Особенности разработки

* Основная логика находится в `src/content-scripts/isolated.js`. Файл `src/content-scripts/main.js` используется только для передачи `sessionId`.
* Стили для `content-script` не обновляются в hot-reload. Если добавляете новый Tailwind-класс - перезапустите сборку (`npm run dev`), чтобы он попал в бандл.
* В Vue-компонентах внутри `content-script` не используйте блок `style`. Это ломает приложение из-за особенностей сборщика. Пишите стили через Tailwind или инлайн.
* Всё остальное - по аналогии с текущим кодом. Сохраняйте стиль и используйте линтеры.
* Не забывайте менять версию расширения в `package.json`

### Линтеры

> ⚠️ Включи в своём IDE

* ESLint
* Stylelint

```bash
npx eslint src/**/*.{js,vue} --fix
```
